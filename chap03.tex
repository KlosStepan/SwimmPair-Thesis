\chapter{Implementation}
DDetailed description of all components and  functions here.  
\begin{csharpcode}
//UDPHandler Constructor 
public UDPHandler(String IP, Int32 Port, Int32 Timeout)
{
    ServerAddr = IPAddress.Parse(IP);
    EndPoint = new IPEndPoint(ServerAddr, Port);
    sock.ReceiveTimeout = Timeout;
    s = new UdpClient(IP, Port);
    
    EncryptionKeyDefault = "YiyM/f2zNq5GkVmiUMJ8qVACaPaBBo5AJRqkIH9cgd4=";
    EncryptionIVDefault = "tLafaj6+1YCiIIvbMO7iN/9QVLK1PPjRzARR9Fsh82c=";
}
\end{csharpcode}
PHP Code
\begin{phpcode}
<?php
class Payload
{
    public $Nth;
    public $outOfN;
    public $content;
    //konstruktor
    public function __construct($Nth, $outOfN, $content)
    {
        $this->Nth = $Nth;
        $this->outOfN = $outOfN;
        $this->content = $content;
    }
}
?>
\end{phpcode}

\section{Database design}
dbd
\subsection{Object tables}
\subsection{Relationship tables}
\subsection{Schema}
Export a picture here.
\section{Controllers documentation}
\par These five controllers are used followingly
\subsection{PostsManager.php}
\begin{itemize}
  \setlength\itemsep{0em}
  \item \underline{Post} $\vert$ null $\leftarrow$ \textbf{GetPostById}(\$id) $\searrow$ \_CreatePostOrNullFromStatement(\$stmt) $\searrow$ \_CreatePostFromRow(\$row)
  \item \underline{Post[]} $\vert$ null $\leftarrow$ \textbf{GetLastThreePosts}() $\searrow$ \_CreatePostsFromStatement() $\searrow$ \_CreatePostFromRow(\$row)
  \item \underline{Post[]} $\vert$ null $\leftarrow$ \textbf{GetLastNPosts}(\$N) $\searrow$ \_CreatePostsFromStatement() $\searrow$ \_CreatePostFromRow(\$row)
  \item \underline{true} $\vert$ false $\leftarrow$ \textbf{AddNewPost}(\$title, \$content)
  \item \underline{Post[]} $\vert$ false $\leftarrow$ \textbf{FindAllPostsOrderedByIdDesc}() $\searrow$ \_CreatePostsFromStatement(\$stmt) $\searrow$ \_CreatePostFromRow(\$row)
  \item \underline{true} $\vert$ false $\leftarrow$ \textbf{UpdatePost}(\$id, \$title, \$article)
\end{itemize}
\subsection{UsersManager.php}
\begin{itemize}
  \setlength\itemsep{0em}
  \item \underline{User} $\vert$ null $\leftarrow$ \textbf{GetUserById}(\$id) $\searrow$ \_CreateUserOrNullFromStatement(\$stmt) $\searrow$ \_CreateUserFromRow(\$row)
  \item \underline{User[]} $\vert$ null $\leftarrow$ \textbf{FindAllActiveUsersOrderByLastNameDesc} $\searrow$ \_CreateUsersFromStatement(\$stmt) $\hookrightarrow$ \_CreateUserFromRow (\$row)
  \item \underline{User[]} $\vert$ null $\leftarrow$ \textbf{FindAllInactiveUsersOrderByLastNameDesc} $\searrow$ \_CreateUsersFromStatement(\$stmt) $\hookrightarrow$ \_CreateUserFromRow (\$row)
  \item \underline{User[]} $\vert$ null $\leftarrow$ \textbf{FindAllRegisteredComradesForTheCup}(\$cupID, \$teamID) $\searrow$ \_CreateUsersFromStatement(\$stmt) $\hookrightarrow$ \_CreateUserFromRow (\$row)
  \item \underline{User[]} $\vert$ null $\leftarrow$ \textbf{FindAllComrades}(\$teamID) $\searrow$ \_CreateUsersFromStatement(\$stmt) $\hookrightarrow$ \_CreateUserFromRow(\$row)
  \item \underline{User[]} $\vert$ null $\leftarrow$ \textbf{FindAllRegisteredUsersForTheCup}(\$cupID) $\searrow$ \_CreateUsersFromStatement(\$stmt) $\hookrightarrow$ \_CreateUserFromRow(\$row)
  \item \underline{User[]} $\vert$ null $\leftarrow$ \textbf{FindAllNametagsForTheCup}(\$cupID) $\searrow$ \_CreateUsersFromStatement(\$stmt) $\hookrightarrow$ \_CreateUserFromRow(\$row)
  \item \underline{User[]} $\vert$ null $\leftarrow$ \textbf{FindPairedUsersOnCupForPosition}(\$cupID, \$posID) $\searrow$ \_CreateUsersFromStatement(\$stmt) $\hookrightarrow$ \_CreateUserFromRow(\$row)
  \item \underline{Pair[]} $\vert$ null $\leftarrow$ \textbf{FindPairedPozIDUserIDOnCup}(\$cupID) $\searrow$ \_CreatePairsFromStatement(\$stmt) $\hookrightarrow$ \_CreatePairFromRow(\$row)
  \item \underline{string} $\vert$ null $\leftarrow$ \textbf{GetClubAbbreviationByAffiliationId}(\$id) $\searrow$ \_GetSingleResultFromStatement(\$stmt)
  \item \underline{string} $\vert$ null $\leftarrow$ \textbf{GetUserFullNameById}(\$id) $\searrow$ \_GetSingleResultFromTwoColsStatement(\$stmt)
  \item \underline{true} $\vert$ \underline{false} $\leftarrow$ \textbf{UserWithEmailExists}(\$email)
  \item \underline{true} $\vert$ false $\leftarrow$ \textbf{RegisterUserFromAdmin}(\$first\_name, \$last\_name, \$email, \$password, \$rights, \$klubaffil)
  \item \underline{true} $\vert$ false $\leftarrow$ \textbf{SendYouWereRegisteredFromAdmin}(\$email, \$password)
  \item \underline{true} $\vert$ false $\leftarrow$ \textbf{ApproveUser}(\$userID)
  \item \underline{true} $\vert$ false $\leftarrow$ \textbf{UpdatePairing}(\$JSON) //TBReimplemented in controller
  \item \underline{true} $\vert$ false $\leftarrow$ \textbf{RegisterUserFromAdminWrap}(\$first\_name, \$last\_name, \$email, \$password, \$prava, \$klub) check, register if possible ($\searrow$ true(not registering) | \underline{false} $\leftarrow$ userWithEmailExists(\$email) | $\searrow$ registerUserFromAdmin(\$first\_name, \$last\_name, \$email, \$password, \$prava, \$klub))
  \item \underline{token(Action::SUCC, -creds-)} $\vert$ token(Action::UNFOUND, -null-) | token(Action::WRONGCRED, -null-) $\leftarrow$ \textbf{loginFromXamarin}(\$username, \$password)
\end{itemize}
\subsection{ClubsManager.php}
\begin{itemize}
  \setlength\itemsep{0em}
  \item \underline{Club} | null $\leftarrow$ \textbf{GetClubById}(\$id) $\searrow$ \_CreateClubFromStatement(\$stmt) $\searrow$ \_CreateClubFromRow(\$row)
  \item \underline{Club []} | null $\leftarrow$ \textbf{FindAllClubs}() $\searrow$ \_CreateClubsFromStatement(\$stmt) $\hookrightarrow$ \_CsreateClubFromRow(\$row)
\end{itemize}
\subsection{CupsManager.php}
\begin{itemize}
  \setlength\itemsep{0em}
  \item \underline{Cup[]} $\vert$ null $\leftarrow$ \textbf{FindAllUpcomingCupsEarliestFirst}() $\searrow$ \_CreateCupsFromStatement(\$stmt) $\hookrightarrow$ \_CreateCupFromRow(\$row)
  \item \underline{Cup[]} $\vert$ null $\leftarrow$ \textbf{FindAllPastCupsMostRecentFirst}() $\searrow$ \_CreateCupsFromStatement(\$stmt) $\hookrightarrow$ \_CreateCupFromRow(\$row)
  \item \underline{string} $\vert$ null  $\leftarrow$ \textbf{GetCupNameById}(\$id) $\searrow$ \_GetSingleResultFromStatement(\$stmt) $\searrow$ \_GetSingleResultFromStatement (\$stmt)
  \item \underline{Cup} $\vert$ null  $\leftarrow$  \textbf{GetCupById}(\$id) $\searrow$ \_CreateCupOrNullFromStatement(\$stmt)  $\searrow$ \_CreateCupFromRow(\$row)
  \item \underline{Pair[]} $\vert$ null $\leftarrow$  \textbf{FindPairingsForThisCup}(\$id) $\searrow$ \_CreatePairsFromStatement(\$stmt) $\hookrightarrow$ \_CreatePairFromRow(\$row)
  \item \underline{true} $\vert$ false $\leftarrow$  \textbf{InsertNewCupFromAdmin}(\$name, \$date, \$club, \$content)
  \item \underline{true} $\vert$ \underline{false} $\leftarrow$  \textbf{IsUserAvailableForTheCup}(\$userID, \$cupID)
  \item \underline{true} $\vert$ false $\leftarrow$  \textbf{UpdatePairingForThisCup}(\$cupID, \$json)
  \item \underline{true} $\vert$ false $\leftarrow$  \textbf{UpdateAvailabilityForThisCup}(\$cupID, \$json)
  \item \underline{true} $\vert$ false $\leftarrow$  \textbf{AddAvailableUserForTheCup}(\$cupID, \$userID)
\end{itemize}
\subsection{PositionsManager.php}
\begin{itemize}
  \setlength\itemsep{0em}
  \item \underline{Position[]} $\vert$ null $\leftarrow$  \textbf{FindAllPositions}() $\searrow$ \_CreatePositionsFromStatement(\$stmt) $\hookrightarrow$ \_CreatePositionFromRow(\$row)
  \item \underline{string} $\vert$ null $\leftarrow$ \textbf{GetPositionNameById}(\$id) $\searrow$ \_GetSingleResultFromStatement(\$stmt)
\end{itemize}
\section{Application structure}
\subsection*{User part of the system}
Whole system must be running on Czech URLs for convinience reasons of administrators. English equivalents are attached. 
\newline
\begin{forest}
  for tree={
    font=\ttfamily,
    grow'=0,
    child anchor=west,
    parent anchor=south,
    anchor=west,
    calign=first,
    edge path={
      \noexpand\path [draw, \forestoption{edge}]
      (!u.south west) +(7.5pt,0) |- node[fill,inner sep=1.25pt] {} (.child anchor)\forestoption{edge label};
    },
    before typesetting nodes={
      if n=1
        {insert before={[,phantom]}}
        {}
    },
    fit=band,
    before computing xy={l=15pt},
  }
[SwimmPair
  [Aktuality index.php \char`\~Posts\char`\~]
  [Zavody \char`\~Cups\char`\~
    [nadchazejici.php \char`\~upcoming.php\char`\~
      [zavod.php \char`\~cup.php\char`\~]
    ]
    [archiv.php \char`\~archive.php\char`\~
      [zavod.php \char`\~cup.php\char`\~] 
    ]
  ]
  [Rozhodci \char`\~Referees\char`\~
    [lide.php \char`\~users.php\char`\~
      [clovek.php \char`\~user.php\char`\~]
    ]
    [kluby.php \char`\~clubs.php\char`\~
      [klub.php \char`\~ club.php\char`\~]
    ]
  ]
  [/pravidla/index.php \char`\~/rules/index.php\char`\~]
  [kontakty.php \char`\~contacts.php\char`\~]
  [/admin/index.php]
]
\end{forest}

\subsection*{User part of the system} 
Administration
\begin{itemize}
    \item pridat\textunderscore aktualitu.php - PŘIDAT AKTUALITU 
    \item editovat\textunderscore aktuality.php - EDITOVAT AKTUALITY -\textgreater editovat\textunderscore aktualitu.php
    \item nove\textunderscore registrovani.php - SCHVÁLIT NOVÉ LIDI 
    \item zaregistrovat\textunderscore uzivatele.php - ZAREGISTROVAT ČLOVĚKA
    \item editovat\textunderscore profily.php EDITOVAT ČLOVĚKA -\textgreater editovat\textunderscore profil.php
    \item novy\textunderscore klub.php NOVÝ KLUB
    \item sprava\textunderscore klubu.php - EDITOVAT KLUB -\textgreater editovat\textunderscore klub.php
    \item novy\textunderscore kraj.php PŘIDAT KRAJ
    \item sprava\textunderscore kraju.php SPRÁVA KRAJŮ -\textgreater editovat\textunderscore kraj.php
    \item konfigurace\textunderscore statistik.php - KONFIGURACE STATISTIK
    \item editovat\textunderscore stranku?id=1 - EDITOVAT KONTAKTY
\end{itemize}      
My Club
\begin{itemize}
    \item pridat\textunderscore zavod.php - PŘÍDAT ZÁVOD
    \item prihlasit\textunderscore moje\textunderscore lidi.php - PŘIHLÁÍSIT LIDI Z MÉHO -\textgreater prihlasit\textunderscore moje\textunderscore lidi\textunderscore na.php
\end{itemize} 
Me referee
\begin{itemize}
    \item sebe\textunderscore na\textunderscore zavod.php - PŘIHLÁSIT SE NA ZÁVOD -\textgreater prihlasit\textunderscore se\textunderscore na.php
\end{itemize}    
\section{JavaScript functions documentation}
Several cool features for the web to make it more useful are described here.
\subsection*{XMLHttpRequest/}
\begin{itemize}
    \item getarticleid.php, \textbf{GET args}: id
    \item getpersonstatisticsfortheseason.php, \textbf{GET args}: user\textunderscore id, year
    \item getclubstatisticsfortheseason.php, \textbf{GET args}: club\textunderscore id, year
\end{itemize}
\subsection{Previous post}
This button on the main page serves as a tool for loading next post. This button has onclick="GetPostAppendPost(PushLastID())". These are both JavaScript functions, PushLastID() detects id "I" of last post from DOM by query and returns it. This value is then used as an argument of call GetPostAppendPost(I). This function requests article by opening GET request XMLHttpRequest/getarticleid?id="I". If result is null, button is deleted since there are no other articles to pull from DB. Otherwise next article is constructed.
\subsection{Personal statistics change year}
All individual referees have season picker when opened. Default season is this season. Clicking different season visibily changes selected year and obtains statistics and updates the table. Clicking onclick="processPersonForTheSeason(user-id, updatePairingForThisCup)" calls communicateStatsXHRAndPopulateStats(user-id, year) which gets data from XMLHttpRequest/getpersonstatisticsfortheseason. 
\subsection{Club statistics change year}
Club statistics are updated by clicking appropriate year, which gets visibly switched. Year onclick calls processClubForTheSeason(club-id, this) which gets statistics by calling communicateClubStatisticsXMHAndPopulateTable(club-id, year) which gets data by calling XMLHttpRequest/getclubstatisticsfortheseason and subsequently calling refreshClubStatsInTheTable(returnedGetJSON) which literally puts the stats in.
\subsection{Filtering referees}
This function is triggered by one of these: KrajPickerTapped(this), TridaPickerTapped(this) or SearchPerformed(). Each one calls FilterRozhodci("kraje", "tridy", "inputTrida", "nopplfound"). We then loop all people visible/hidden and check if this one's Region IsPermissible(args[]), then if one's Class IsPermissible(args[]) and then if one's IsNamePermissible(args[]). We then set one element style to style="" and continue cycle execution. If we fail one of these three conditions we proceed to code below which sets element style to style="display:none". After the cycle when check the aux variable and if our query is indeed empty we write it for the user.
\par
This long procedure gets triggered and subsequently executed everytime region, class or name is changed. Performance should be fine here since the algorithm is dependent on human input. 
\section{Mobile app structure}
Phone version of our administration follows the same structure. All objects are same, including data type, which have to be explicitly defined, unline in PHP.
\section{Mobile app communication}
